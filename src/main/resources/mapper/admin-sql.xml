<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="admin">

	<select id="selectMemberList" parameterType="hashmap" resultType="hashmap">
		SELECT
			m_no,
			m_name,
			m_email,
			m_password,
			m_phone,
			to_char(M_DATE,'yyyy/MM/dd') as m_date
		FROM
			members
		ORDER BY
			m_no DESC
	</select>
	
	<insert id="insertLendplace" parameterType="hashmap">
		INSERT INTO lendplace
		VALUES
		(
			lendplace_seq.nextval,
			#{l_name},
			#{l_email},
			#{l_phone},
			#{l_title},
			#{l_addr},
			#{l_content},
			#{l_rep_img},
			#{l_pnum},
			#{l_sdate},
			#{l_edate},
			0,
			0,
			sysdate
		)
	</insert>
	
	<select id="selectMemberModifyForm" parameterType="hashmap" resultType="hashmap">
		SELECT
			m_no,
			m_name,
			m_email,
			m_password,
			m_phone,
			to_char(M_DATE,'yyyy/MM/dd') as m_date
		FROM
			members
		WHERE
			m_no = #{m_no}
	</select>

	<update id="adminMemberModify" parameterType="hashmap">
		UPDATE
			members
		SET
			m_name=#{m_name}, m_password=#{m_password}, m_phone=#{m_phone}
        WHERE
        	m_email=#{m_email}
	</update>
	
	<delete id="deleteMember" parameterType="hashmap">
		{call
			declare
			begin
				DELETE FROM comments WHERE m_no=#{m_no};
				DELETE FROM board WHERE m_no=#{m_no};
				DELETE FROM qna WHERE m_no=#{m_no};
				DELETE FROM meetingsapplyfor WHERE m_no=#{m_no};
				DELETE FROM likeit WHERE m_no=#{m_no};
				DELETE FROM meetings WHERE m_no=#{m_no};
				DELETE FROM lendplaceapplyfor WHERE m_no=#{m_no};
				DELETE FROM members WHERE m_no=#{m_no};
			end
		}
	</delete>
</mapper>